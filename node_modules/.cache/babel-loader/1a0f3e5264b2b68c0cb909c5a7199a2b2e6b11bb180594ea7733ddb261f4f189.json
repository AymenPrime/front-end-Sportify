{"ast":null,"code":"import React,{useState}from'react';import'./login.css';import videoSource from'../assets/background-video.mp4';import{useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function LoginPage(_ref){let{setStatus}=_ref;const[username,setUsername]=useState(\"\");const[password,setPassword]=useState(\"\");const[error,setError]=useState(\"\");const navigate=useNavigate();const HandleLogin=async e=>{e.preventDefault();setError(\"\");// Clear any previous errors\ntry{// Step 1: Authenticate and get tokens\nconst tokenResponse=await fetch('http://127.0.0.1:8000/api/auth/token',{method:\"POST\",body:JSON.stringify({login:username,password:password}),headers:{\"Content-type\":\"application/json\",\"Accept\":\"application/json\"}});if(!tokenResponse.ok){throw new Error(\"Invalid username or password\");}const tokenData=await tokenResponse.json();localStorage.setItem(\"accessToken\",tokenData.access);localStorage.setItem(\"refreshToken\",tokenData.refresh);// Step 2: Fetch user details\nconst userResponse=await fetch('http://localhost:8000/api/users/me',{method:\"GET\",headers:{\"Content-type\":\"application/json\",\"Accept\":\"application/json\",\"Authorization\":`Bearer ${tokenData.access}`}});if(!userResponse.ok){throw new Error(\"Failed to fetch user details\");}const userData=await userResponse.json();const isAdmin=userData.user.is_admin===true;// Step 3: Update admin status and navigate\nsetStatus(isAdmin);navigate('/');}catch(error){setError(error.message||\"Something went wrong. Please try again.\");console.error(\"Login error:\",error);}};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"content-login\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"firstlayer-one\"}),/*#__PURE__*/_jsx(\"video\",{autoPlay:true,muted:true,loop:true,id:\"myVideo-login\",children:/*#__PURE__*/_jsx(\"source\",{src:videoSource,type:\"video/mp4\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"login-page\",children:/*#__PURE__*/_jsx(\"div\",{className:\"login-container\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"login-form\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"login-title\",children:\"Login\"}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"login-error\",children:error}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"username\",className:\"login-label\",children:\"Username\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:username,onChange:e=>setUsername(e.target.value),id:\"username\",placeholder:\"Enter your username\",className:\"login-input\",required:true}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",className:\"login-label\",children:\"Password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",value:password,onChange:e=>setPassword(e.target.value),id:\"password\",placeholder:\"Enter your password\",className:\"login-input\",required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",onClick:HandleLogin,className:\"login-button\",children:\"Log In\"})]})})})]})});}export default LoginPage;","map":{"version":3,"names":["React","useState","videoSource","useNavigate","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","LoginPage","_ref","setStatus","username","setUsername","password","setPassword","error","setError","navigate","HandleLogin","e","preventDefault","tokenResponse","fetch","method","body","JSON","stringify","login","headers","ok","Error","tokenData","json","localStorage","setItem","access","refresh","userResponse","userData","isAdmin","user","is_admin","message","console","children","className","autoPlay","muted","loop","id","src","type","htmlFor","value","onChange","target","placeholder","required","onClick"],"sources":["/goinfre/aait-our/site/src/login/login.js"],"sourcesContent":["import React, { useState } from 'react';\nimport './login.css';\nimport videoSource from '../assets/background-video.mp4';\nimport { useNavigate } from 'react-router-dom';\n\nfunction LoginPage({ setStatus }) {\n  const [username, setUsername] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [error, setError] = useState(\"\");\n  const navigate = useNavigate();\n\n  const HandleLogin = async (e) => {\n    e.preventDefault();\n    setError(\"\"); // Clear any previous errors\n\n    try {\n      // Step 1: Authenticate and get tokens\n      const tokenResponse = await fetch('http://127.0.0.1:8000/api/auth/token', {\n        method: \"POST\",\n        body: JSON.stringify({\n          login: username,\n          password: password,\n        }),\n        headers: {\n          \"Content-type\": \"application/json\",\n          \"Accept\": \"application/json\",\n        },\n      });\n\n      if (!tokenResponse.ok) {\n        throw new Error(\"Invalid username or password\");\n      }\n\n      const tokenData = await tokenResponse.json();\n      localStorage.setItem(\"accessToken\", tokenData.access);\n      localStorage.setItem(\"refreshToken\", tokenData.refresh);\n\n      // Step 2: Fetch user details\n      const userResponse = await fetch('http://localhost:8000/api/users/me', {\n        method: \"GET\",\n        headers: {\n          \"Content-type\": \"application/json\",\n          \"Accept\": \"application/json\",\n          \"Authorization\": `Bearer ${tokenData.access}`,\n        },\n      });\n\n      if (!userResponse.ok) {\n        throw new Error(\"Failed to fetch user details\");\n      }\n\n      const userData = await userResponse.json();\n      const isAdmin = userData.user.is_admin === true;\n\n      // Step 3: Update admin status and navigate\n      setStatus(isAdmin);\n      navigate('/');\n    } catch (error) {\n      setError(error.message || \"Something went wrong. Please try again.\");\n      console.error(\"Login error:\", error);\n    }\n  };\n\n  return (\n    <>\n      <div className='content-login'>\n        <div className='firstlayer-one'></div>\n        <video autoPlay muted loop id=\"myVideo-login\">\n          <source src={videoSource} type=\"video/mp4\" />\n        </video>\n        <div className='login-page'>\n          <div className=\"login-container\">\n            <form className=\"login-form\">\n              <h1 className=\"login-title\">Login</h1>\n\n              {error && <div className=\"login-error\">{error}</div>}\n\n              <label htmlFor=\"username\" className=\"login-label\">Username</label>\n              <input\n                type=\"text\"\n                value={username}\n                onChange={(e) => setUsername(e.target.value)}\n                id=\"username\"\n                placeholder=\"Enter your username\"\n                className=\"login-input\"\n                required\n              />\n\n              <label htmlFor=\"password\" className=\"login-label\">Password</label>\n              <input\n                type=\"password\"\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n                id=\"password\"\n                placeholder=\"Enter your password\"\n                className=\"login-input\"\n                required\n              />\n\n              <button type=\"submit\" onClick={HandleLogin} className=\"login-button\">\n                Log In\n              </button>\n            </form>\n          </div>\n        </div>\n      </div>\n    </>\n  );\n}\n\nexport default LoginPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}